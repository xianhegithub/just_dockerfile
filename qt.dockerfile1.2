ARG BASE_CONTAINER=tensorflow/tensorflow:2.1.0-gpu-py3-jupyter
FROM $BASE_CONTAINER

RUN pip install --quiet --upgrade pip
RUN pip install --quiet numpy==1.17.4
RUN pip uninstall -y enum34
RUN pip install --quiet zipline==1.3.0
RUN pip install --quiet jupyterlab==1.2.5

#install python packages
RUN pip install --quiet matplotlib==3.1.2 seaborn==0.10.0 pandas==0.22 quandl==3.4.8 pandas-datareader==0.8.0 statsmodels==0.11.0 pymc3==3.8 nodejs==0.1.0

RUN pip install --quiet pykalman==0.9.5 scikit-learn==0.22.1 imbalanced-learn==0.6.2 lightgbm==2.3.1 plotly==4.5.2 xgboost==0.90 eli5==0.10.1 shap==0.34.0 ipywidgets==7.4.2

RUN curl -O -L http://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-src.tar.gz
RUN tar -xzf ta-lib-0.4.0-src.tar.gz
RUN cd ta-lib/
RUN make install
RUN cd ~

RUN pip install --quiet TA-lib

RUN mkdir -p /home/xianhe && chmod 1777 /home/xianhe
ENV HOME /home/xianhe
# Define working directory.
WORKDIR /home/xianhe

CMD ["jupyter","lab","--port=8888","--no-browser","--ip=0.0.0.0","--allow-root"]
