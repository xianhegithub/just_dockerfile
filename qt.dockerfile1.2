ARG BASE_CONTAINER=tensorflow/tensorflow:2.1.0-gpu-py3-jupyter
FROM $BASE_CONTAINER

#jupyter lab dependencies
RUN apt-get update && apt-get install -y --no-install-recommends \
         libsm6 \
         libxext6 \
         libxrender-dev \
         ffmpeg && \
     rm -rf /var/lib/apt/lists/*

RUN pip install --quiet --upgrade pip
RUN pip install --quiet numpy==1.17.4
RUN pip uninstall -y enum34
RUN pip install --quiet zipline==1.3.0
RUN pip install --quiet jupyterlab==1.2.5

RUN mkdir -p /home/xianhe && chmod 1777 /home/xianhe
ENV HOME /home/xianhe

# jupyter notebook
EXPOSE 8888

CMD ["jupyter","lab","--port=8888","--no-browser","--ip=0.0.0.0","--allow-root"]
CMD ["cd","/home/xianhe"]
